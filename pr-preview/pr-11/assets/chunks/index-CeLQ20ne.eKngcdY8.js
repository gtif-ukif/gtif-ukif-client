const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/chunks/main.BmwctLhM.js","assets/chunks/lit-element.CIht5NN8.js","assets/chunks/map.DiiNQ3pp.js","assets/chunks/when.BR7zwNJC.js","assets/chunks/addCommonStyleSheet.bNTycqZz.js","assets/chunks/dayjs.min.Ba62AOpW.js","assets/chunks/commonjsHelpers.BosuxZz1.js","assets/chunks/index.BUIxO2d3.js","assets/chunks/static.DC84-iQq.js","assets/chunks/repeat.9Pq2frlr.js","assets/chunks/directive.CvdRHFdJ.js","assets/chunks/directive-helpers.BMu_cjfm.js","assets/chunks/unsafe-html.RlppLW26.js","assets/chunks/toolcool-range-slider.min.BBXDELo7.js","assets/chunks/orient2d.DArCjZZA.js","assets/chunks/index.CxojoGlr.js"])))=>i.map(i=>d[i]);
import{ao as b,a2 as T,p as _,x as f,c as $,o as k,G as I,j as d,w as V,t as F,k as c,v,a5 as B}from"./framework.BW8QLPtK.js";import{_ as O,i as M,a as g,j as R,k as A,n as H,o as n,p as K,q as C}from"./eo-dash.BNcUFVrv.js";import{i as N}from"./easing-CH0-9wR8.CTB3jml5.js";import j from"./EodashLayoutSwitcher-wm62dUEA.BXmt0yPA.js";import"./item.Bx-rtsOD.js";import"./commonjsHelpers.BosuxZz1.js";import"./VTooltip-DWWNWX05.BYX-cHVy.js";import"./forwardRefs-DMEdP2Ni.B_n8ScXh.js";import"./transition-CTorPxg9.KClv2Jam.js";const U=s=>a=>{let t="";return s.forEach(r=>{const i=r.property;if(!r.icon&&!r.unitLabel||!a.properties[i])return;r.icon&&(t+=r.icon);let e=a.properties[i];typeof e=="number"&&!Number.isInteger(e)&&(e=e.toFixed(1)),t+=e,r.unitLabel&&(t+=r.unitLabel)}),t},D=s=>{var i;const t=[{key:"collection",title:"Collections",type:"multiselect",placeholder:"Select collections",inline:!1,filterKeys:((i=g().stac)==null?void 0:i.map(e=>e.id))||[],...A.value&&{state:{[A.value]:!0}}}],r=s.map(e=>{const l=`properties.${e.property}`;return e.type==="range"?{key:l,title:e.title||e.property,type:"range",expanded:!0,filterKeys:[e.min||0,e.max||100],state:{min:e.min??0,max:e.max??100}}:e.type==="multiselect"?{key:l,title:e.title||e.property,type:"multiselect",placeholder:e.placeholder||`Select ${e.property}`,inline:!1,filterKeys:e.filterKeys||[],state:e.state}:e.type==="select"?{key:l,title:e.title||e.property,type:"select",placeholder:e.placeholder||`Select ${e.title||e.property}`,filterKeys:e.filterKeys||[],state:e.state}:null}).filter(Boolean);return[...t,...r]},G=(s,a)=>{const t=[];return a.forEach(r=>{const i=`properties.${r.property}`,e=s[i];if(e){if(r.type==="range"&&e.state){const{min:l,max:o}=e.state;l!==void 0&&l>(r.min||0)&&t.push(`${r.property}>=${l}`),o!==void 0&&o<(r.max||100)&&t.push(`${r.property}<=${o}`)}else if(r.type==="multiselect"&&e.stringifiedState){const l=e.stringifiedState;l.length>0&&t.push(`${r.property} IN (${l})`)}else if(r.type==="select"&&e.stringifiedState){const l=e.stringifiedState;l&&t.push(`${r.property}='${l}'`)}}}),t.join(" AND ")},J=(s,a,t)=>{var l,o;const r=g(),i=new URLSearchParams;(l=s.collection)!=null&&l.stringifiedState&&i.append("collections",s.collection.stringifiedState.replaceAll(" ","")),(o=n.value)!=null&&o.lonLatExtent&&t&&i.append("bbox",K([...n.value.lonLatExtent]).join(","));const e=G(s,a);return e&&i.append("filter",e),i.append("limit","100"),`${r.stacEndpoint}/search?${i.toString()}`},q=(s,a)=>(t,r)=>({url:J(r,s,a),key:"features"});function y(s){var i,e;let a=(e=(i=n.value)==null?void 0:i.layers)==null?void 0:e.find(l=>{var o;return((o=l.properties)==null?void 0:o.id)==="AnalysisGroup"});if(!n.value||!s)return;a||(a={type:"Group",properties:{id:"AnalysisGroup",title:"Data Layers"},layers:[]},n.value.layers=[...n.value.layers,a]);const t={type:"Vector",properties:{id:"stac-items",title:"STAC Items"},source:{type:"Vector",url:"data:application/geo+json,"+encodeURIComponent(JSON.stringify({type:"FeatureCollection",features:s})),format:"GeoJSON"},style:{"fill-color":"transparent","stroke-color":"#003170"},interactions:[{type:"select",options:{id:"stac-items",condition:"pointermove",style:{"stroke-color":"white","stroke-width":3}}}]};if(a.layers.some(l=>{var o;return((o=l.properties)==null?void 0:o.id)==="stac-items"})){n.value.addOrUpdateLayer(t);return}else a.layers.push(t),n.value.layers=[...n.value.layers]}const z=(s,a)=>{if(!a)return;let t;const r=()=>{clearTimeout(t),t=setTimeout(()=>{var i;(i=s.value)==null||i.search()},800)};v(()=>{var i;(i=n.value)==null||i.map.on("moveend",r)}),f(()=>{var i;(i=n.value)==null||i.map.un("moveend",r)})},Y=s=>{v(()=>{y(s.value)}),H(()=>{y(s.value)})};function Z(s){const a=t=>{var e,l,o;const r=(l=(e=t.detail)==null?void 0:e.feature)==null?void 0:l.getId();if(!r)return;const i=(o=s.value.items)==null?void 0:o.find(m=>m.id===r);i&&(s.value.selectedResult=i)};v(()=>{var t;(t=n.value)==null||t.addEventListener("select",a)}),f(()=>{var t;(t=n.value)==null||t.removeEventListener("select",a)})}const Q=s=>a=>{s.value=a.detail.results,y(s.value)},W=s=>async a=>{var r,i,e;const t=a.detail;t&&(((r=s.selectedStac)==null?void 0:r.id)===t.collection?s.selectedItem=t:await s.loadSelectedSTAC(t.collection,!1,t),(e=(i=n.value)==null?void 0:i.selectInteractions["stac-items"])==null||e.highlightById([t.id],{padding:[100,100,100,100],duration:1200,easing:N}))},w=s=>{var a,t;(t=(a=n.value)==null?void 0:a.selectInteractions["stac-items"])==null||t.highlightById([s.detail.id])},L=()=>{var s,a;(a=(s=n.value)==null?void 0:s.selectInteractions["stac-items"])==null||a.highlightById([])},X="eox-itemfilter[data-v-4d4f6477]{flex-basis:20%;height:100%;overflow:hidden!important;padding:1rem;--eox-itemfilter-results-color: var(--v-theme-surface) !important}.title[data-v-4d4f6477]{padding:1em;margin:.2em}",ee=[".imageProperty",".subTitleProperty",".filterProperties",".items","externalFilter"],te={slot:"filterstitle",style:{margin:"14px 8px"}},se={slot:"resultstitle",style:{margin:"14px 8px"}},re={__name:"index",props:{title:{type:String,default:"Explore Catalog"},layoutTarget:{type:String,default:"lite"},layoutIcon:{type:String,default:M},filtersTitle:{type:String,default:"Filters:"},resultsTitle:{type:String,default:"Items:"},bboxFilter:{type:Boolean,default:!0},imageProperty:{type:String,default:"assets.thumbnail.href"},filters:{type:Array,default:()=>[{property:"eo:cloud_cover",type:"range",title:"Cloud Cover (%)",min:0,max:100,icon:'<svg style="height: 1rem; transform: translateY(-2px); fill: currentColor" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>weather-cloudy</title><path d="M6,19A5,5 0 0,1 1,14A5,5 0 0,1 6,9C7,6.65 9.3,5 12,5C15.43,5 18.24,7.66 18.5,11.03L19,11A4,4 0 0,1 23,15A4,4 0 0,1 19,19H6M19,13H17V12A5,5 0 0,0 12,7C9.5,7 7.45,8.82 7.06,11.19C6.73,11.07 6.37,11 6,11A3,3 0 0,0 3,14A3,3 0 0,0 6,17H19A2,2 0 0,0 21,15A2,2 0 0,0 19,13Z" /></svg>',unitLabel:"%"}]}},async setup(s){let a,t;customElements.get("eox-itemfilter")||([a,t]=b(()=>B(()=>import("./main.BmwctLhM.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]))),await a,t());const r=s,i=g(),e=T("itemfilter"),l=_([]);[a,t]=b(()=>C.get(i.stacEndpoint+"/search?limit=100").then(S=>l.value=S.data.features)),await a,t();const o=l.value,m=D(r.filters),E=U(r.filters),P=q(r.filters,r.bboxFilter),h=Q(l),x=W(i);return Y(l),z(e,r.bboxFilter),Z(e),f(()=>{i.selectedItem=null}),(S,p)=>(k(),$("span",null,[I(R,{class:"title align-center justify-space-between"},{default:V(()=>[p[4]||(p[4]=d("h4",null,"Catalog Items",-1)),I(j,{target:s.layoutTarget,icon:s.layoutIcon},null,8,["target","icon"])]),_:1}),d("eox-itemfilter",{ref:"itemfilter",titleProperty:"id",".imageProperty":s.imageProperty,".subTitleProperty":c(E),".filterProperties":c(m),".items":c(o),onSelect:p[0]||(p[0]=(...u)=>c(x)&&c(x)(...u)),onFilter:p[1]||(p[1]=(...u)=>c(h)&&c(h)(...u)),"onMouseenter:result":p[2]||(p[2]=(...u)=>c(w)&&c(w)(...u)),"onMouseleave:result":p[3]||(p[3]=(...u)=>c(L)&&c(L)(...u)),externalFilter:c(P)},[d("h4",te,F(s.filtersTitle),1),d("h4",se,F(s.resultsTitle),1)],40,ee)]))}},me=O(re,[["styles",[X]],["__scopeId","data-v-4d4f6477"]]);export{me as default};
